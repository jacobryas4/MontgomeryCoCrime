<html>
    <head>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
    </head>
    <body>

        <script>
            
                    var listOfLocalities = [];
                    var localities = [];
                    var crimes = [];
                    var citiesAndSums = [];
                    d3.csv('data/CrimeUpdated.csv', function(data) 
                    {
                        for (var i = 0; i < data.length; i++) {
                            
                            localities[i] = {
                                city: data[i]["City "],
                                crime: data[i]["Crime Name2"],
                            }
                            
                        }

                        // loop through localities and create crime sums
                        for (var x = 0; x < localities.length; x++) {

                            if (!listOfLocalities.includes(localities[x].city)) {
                                listOfLocalities.push(localities[x].city);
                            }
                            if (!crimes.includes(localities[x].crime) && localities[x].crime !== 'NOT NIBRS CODE' && localities[x].crime !== 'All Other Offenses') {
                                crimes.push(localities[x].crime);
                            }
                        }
                    
                    });
                    

                    function dataReady() {
                        // make bar chart
                        drawBarChart('United States');
            
                        // populate selection list
                        d3.select('#selectionWidget').selectAll('option').data(listOfLocalities).enter().append('option')
                            .html(function(d) { return d; })
                            .attr('value', function(d) { return d; })
            
                        d3.select("#selectionWidget")
                            .on('change', function() {
            
                                // clear the contents of the chart
                                d3.select("#main").selectAll('g').remove();
            
                                // figure out the newly selected locality
                                var selection = document.getElementById('selectionWidget');
                                var localityName = selection.options[selection.selectedIndex].value;
            
                                console.log('new locality: ' + localityName);
            
                                // re-draw bar chart for the new locality
                                drawBarChart(localityName);
                            });
                    }
                        
            
                    function drawBarChart(localityName)
                    {
                        // drawing code here
                    }
                    
                </script>
    </body>
</html>